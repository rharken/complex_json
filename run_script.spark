val df = spark.read.json("./applisttest.json");
val df1 = df.withColumn("app", explode($"apps")).drop($"apps");
val df2 = df1.withColumn("appName", $"app.appName").withColumn("appPackage", $"app.appPackage").withColumn("Ratings", explode($"app.Ratings")).drop($"app")
df2.groupBy("id", "appName", "appPackage").avg("Ratings.Rating").orderBy("appName").show
